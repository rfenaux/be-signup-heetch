var wpWidgetOpts;!function(t){var e=t(document);wpWidgetOpts={hoveredSidebar:null,init:function(){var i=this,s=t(".wp-admin.widgets-php .wrap a.page-title-action"),d=t(".extended-widget-opts-tabs"),o=t(".widgetsopts-chooser"),n=o.find(".widgetopts-chooser-sidebars");d.length>0&&i.loaded("","loaded"),t(".widget-liquid-right .widget-opts-color").wpColorPicker(),t(".widget-liquid-right .widget, .inactive-sidebar .widget, #accordion-panel-widgets .customize-control-widget_form").each(function(t,e){i.loaded("","loaded")}),e.on("widget-added",function(t,e){i.loaded(e,"added")}),e.on("widget-updated",function(t,e){i.loaded(e,"updated")}),e.on("click",".extended-widget-opts-inner-lists h4",function(){var e=t(this).attr("id");t(".extended-widget-opts-inner-lists ."+e).slideToggle(250)}),e.on("click",".widget-opts-toggler-note",function(e){t(this).parent("p").parent(".widget-opts-logic").find(".widget-opts-toggle-note").slideToggle(250),e.preventDefault(),e.stopPropagation()}),i.image_upload(),s.length>0&&s.after('<a href="'+widgetopts10n.opts_page+'" class="page-title-action hide-if-no-customize">'+widgetopts10n.translation.manage_settings+"</a>"),i.live_search(),t(".widget-control-actions .alignleft .widget-control-remove").after(widgetopts10n.controls),i.do_chooser(o,n),i.sidebarOptions(),i.removeSidebarWidgets()},loaded:function(e,i){var s,d=0,o=0,n=0,a=0,r=!1,l=".widget-opts-color",c=".extended-widget-opts-tabs",p=".extended-widget-opts-styling-tabs",g=".extended-widget-opts-visibility-tabs",h=".extended-widget-opts-settings-tabs",w="#extended-widget-opts-selectedtab",f="#extended-widget-opts-styling-selectedtab",u="#extended-widget-opts-visibility-selectedtab",v="#extended-widget-opts-settings-selectedtab";"undefined"!=typeof wp&&(r="undefined"!=typeof wp.customize),""!=e&&(s="#"+e.attr("id"),t(s).find(w).length>0&&(d=t("#"+e.attr("id")).find(w).val(),d=parseInt(d)),t(s).find(f).length>0&&(o=t("#"+e.attr("id")).find(f).val(),o=parseInt(o)),t(s).find(u).length>0&&(n=t("#"+e.attr("id")).find(u).val(),n=parseInt(n)),t(s).find(v).length>0&&(a=t("#"+e.attr("id")).find(v).val(),a=parseInt(a)),t(s).find(l).length>0&&(r?t(s).find(l).wpColorPicker({change:_.throttle(function(){t(this).trigger("change")},1e3,{leading:!1})}):t(s).find(l).wpColorPicker())),"added"==i&&(d=0,o=0,n=0,a=0),""!=e?(t(s).find(c).length>0&&t(s).find(c).tabs({active:d}),t(s).find(p).length>0&&t(s).find(p).tabs({active:o}),t(s).find(g).length>0&&t(s).find(g).tabs({active:n}),t(s).find(h).length>0&&t(s).find(h).tabs({active:a})):(t(c).tabs({active:d}),t(p).tabs({active:o}),t(g).tabs({active:n}),t(h).tabs({active:a})),t(c).click("tabsselect",function(e,i){t(this).find(w).length>0&&t(this).find(w).val(t(this).tabs("option","active"))}),t(p).click("tabsselect",function(e,i){t(this).find(f).length>0&&t(this).find(f).val(t(this).tabs("option","active"))}),t(g).click("tabsselect",function(e,i){t(this).find(u).length>0&&t(this).find(u).val(t(this).tabs("option","active"))}),t(h).click("tabsselect",function(e,i){t(this).find(v).length>0&&t(this).find(v).val(t(this).tabs("option","active"))}),t(".extended-widget-opts-date").datepicker({beforeShow:function(){setTimeout(function(){t(".ui-datepicker").css("z-index",99999999999999)},0)}})},image_upload:function(){var t;e.on("click",".extended_widget_opts-bg_uploader",function(e){e.preventDefault();var i=jQuery(this).attr("data-widget-id");t=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),t.on("select",function(){attachment=t.state().get("selection").first().toJSON(),jQuery("#extended-widget-opts-tab-"+i+"-styling .extended_widget_opts-bg-image").val(attachment.url).trigger("change")}),t.open()}),e.on("click",".extended_widget_opts-remove_image",function(t){var e=jQuery(this).attr("data-widget-id");jQuery("#extended-widget-opts-tab-"+e+"-styling .extended_widget_opts-bg-image").val("").trigger("change"),t.preventDefault()})},live_search:function(){"undefined"!=typeof t.fn.liveFilter&&t.isFunction(t.fn.liveFilter)&&t("#widgetopts-widgets-search").length>0&&(t(".widget:last-of-type").after('<div class="widgetopts-separator" />'),t("#widgets-left .widget").each(function(){var e=t(this).index()+1;t(this).attr("data-widget-index",e)}),t("#widgets-left").liveFilter("#widgetopts-widgets-search",".widget",{filterChildSelector:".widget-title h4, .widget-title h3",after:function(e,i){i.each(function(){t(this).insertAfter(t(this).parent().find(".widgetopts-separator"))}),e.sort(function(t,e){return t.getAttribute("data-widget-index")-e.getAttribute("data-widget-index")}),e.each(function(){t(this).insertBefore(t(this).parent().find(".widgetopts-separator"))})}}),t("#wpbody-content").on("keyup",".widgetopts-widgets-search",function(e){p=t(this).parent().find(".widgetopts-clear-results"),""!==t(this).val()?p.addClass("widgetopts-is-visible"):p.removeClass("widgetopts-is-visible")}),t("#wpbody-content").on("click",".widgetopts-clear-results",function(e){return s=t(this).parent().find(".widgetopts-widgets-search"),s.val("").focus().trigger("keyup"),"widgetopts-search-chooser"==s.attr("id")?t(".widgets-chooser-sidebars li:not(:first)").removeClass("widgets-chooser-selected"):s.hasClass("widgetsopts-widgets-search")&&t(".widgetopts-chooser-sidebars li:not(:first)").removeClass("widgetopts-chooser-selected"),e.preventDefault(),e.stopPropagation(),!1}),t(".widgets-chooser").prepend(widgetopts10n.search_form),t(".widgets-chooser").liveFilter("#widgetopts-search-chooser",".widgets-chooser-sidebars li",{after:function(e,i){i.each(function(){t(this).addClass("widgetopts-is-hidden").removeClass("widgets-chooser-selected")}),e.each(function(){t(this).removeClass("widgetopts-is-hidden").removeClass("widgets-chooser-selected")}),e.length>0&&t(e[0]).addClass("widgets-chooser-selected")}}))},do_chooser:function(i,s){var d=this;t("#widgets-right .widgets-holder-wrap").each(function(e,i){var d=t(i),o=d.find(".sidebar-name h2").text(),n=d.find(".widgets-sortables").attr("id"),a=t('<li tabindex="0">').text(t.trim(o));0===e&&a.addClass("widgetopts-chooser-selected"),s.append(a),a.attr("data-sidebarId",n)}),e.on("click",".widgetopts-control",function(e){var o=t(this).text(),n=t(this).attr("data-action");t(this).hasClass("widgetopts-control-open")?(d.closeChooser(),t(".widgetopts-control-open").removeClass("widgetopts-control-open")):(i.find(".widgetopts-chooser-action span").text(o),i.find(".widgetopts-chooser-action").attr("data-action",n),t(this).parents(".widget-control-actions").find(".clear").after(i),i.slideDown(300,function(){s.find(".widgets-chooser-selected").focus()}),t(".widgetopts-control-open").removeClass("widgetopts-control-open"),t(this).addClass("widgetopts-control-open"),d.chooserSearch()),e.preventDefault()}),e.on("click",".widgetopts-chooser-sidebars li",function(e){s.find(".widgetopts-chooser-selected").removeClass("widgetopts-chooser-selected"),t(this).addClass("widgetopts-chooser-selected")}),e.on("click",".widgetsopts-chooser .widgetopts-chooser-action",function(i){var s=t("html,body"),d=t(this).attr("data-action"),o=t(this).parents(".widgets-sortables").attr("id"),n=t(this).parents(".widget").attr("id"),a=t("#"+n);switch(sidebarID=t(".widgetopts-chooser-selected").attr("data-sidebarId"),t("#"+n+" .widgetsopts-chooser").remove(),a.find(" .widgetopts-control-open").removeClass("widgetopts-control-open"),d){case"move":t("#"+o).find("#"+n).appendTo("#"+sidebarID),t("#"+sidebarID).sortable("refresh"),a.addClass("widgetopts-move-ds"),t("#"+sidebarID).parent(".widgets-holder-wrap").removeClass("closed"),wpWidgets.save(t("#"+n),0,0,1);break;case"clone":var r=a.clone(),l=a.find(".id_base").val(),c=(a.find(".widget-id").val(),a.find('input[name="widget_number"]').val()),p=t('#widgets-left #widget-list input[class="id_base"][value="'+l+'"]'),g=p.parents(".widget"),h=g.attr("id"),w=p.parent("form"),f=(w.find("input.widget_number").val(),parseInt(w.find("input.multi_number").val())),u=h.replace("__i__",f);r.attr("id",u),r.find("input.widget_number").val(f),r.find("input.add_new").val("multi"),r.find(".widget-content").find("input,select,textarea").each(function(){t(this).attr("name")&&(t(this).attr("name",t(this).attr("name").replace(l+"["+c+"]",l+"["+f+"]")),t(this).attr("name",t(this).attr("name").replace(l+"-"+c,l+"-"+f))),t(this).attr("id")&&t(this).attr("id",t(this).attr("id").replace(l+"-"+c,l+"-"+f))}),r.find('input[name="extended_widget_opts_name"]').val("extended_widget_opts-"+l+"-"+f),r.find('input[value="'+l+"-"+c+'"]').val(l+"-"+f),r.find(".widgetops-sc-opts code").text('[do_widget id="'+l+"-"+f+'"]'),r.find(".widget-control-edit").attr("href",r.find(".widget-control-edit").attr("href").replace(l+"-"+c,l+"-"+f)),r.find(".text-widget-fields").length>0&&r.find(".text-widget-fields").remove(),r.find("a.wp-color-result").length>0&&r.find("a.wp-color-result").remove(),r.addClass("widgetopts-move-ds"),a.find(".widget-inside").slideUp("fast",function(){a.attr("style",""),a.removeClass("open")}),t(r).appendTo("#"+sidebarID),t("#"+sidebarID).sortable("refresh"),t("#"+sidebarID).parent(".widgets-holder-wrap").removeClass("closed"),wpWidgets.save(t("#"+u),0,0,1),t("#"+u).find("input.add_new").val(""),e.trigger("widget-added",[r]),w.find("input.multi_number").val(f+1)}var v=t(".widgetopts-move-ds");s.animate({scrollTop:v.offset().top-(s.offset().top+s.scrollTop()+60)},200),t(".widgetopts-move-ds").removeClass(".widgetopts-move-ds"),i.preventDefault()}),e.on("click",".widgetsopts-chooser .widgetsopts-chooser-cancel",function(t){d.closeChooser(i),t.preventDefault()})},closeChooser:function(e){t(".widgetsopts-chooser").slideUp(200,function(){t(".widgetopts-control").removeClass("widgetopts-control-open"),t("#wpbody-content").append(this)})},chooserSearch:function(){t("#widgetsopts-widgets-search").length>0&&t(".widgetsopts-chooser").liveFilter("#widgetsopts-widgets-search",".widgetopts-chooser-sidebars li",{after:function(e,i){i.each(function(){t(this).addClass("widgetopts-is-hidden").removeClass("widgetopts-chooser-selected")}),e.each(function(){t(this).removeClass("widgetopts-is-hidden").removeClass("widgetopts-chooser-selected")}),e.length>0&&t(e[0]).addClass("widgetopts-chooser-selected")}})},sidebarOptions:function(){widgetopts10n.sidebaropts.length>0&&t("#widgets-right .widgets-holder-wrap").each(function(e,i){dl_link=widgetopts10n.sidebaropts.replace("__sidebaropts__",t(this).find(".widgets-sortables").attr("id")),dl_link=dl_link.replace("__sidebar_opts__",t.trim(t(this).find(".widgets-sortables h2").text())),t(this).append(dl_link)})},removeSidebarWidgets:function(){var i=t("html,body");e.on("click",".sidebaropts-clear",function(e){t(this).parent().find(".sidebaropts-confirm").addClass("sidebaropts-confirmed"),t(this).parent().find(".sidebaropts-confirm").slideToggle(250),e.preventDefault()}),e.on("click",".sidebaropts-confirmed .button",function(e){if(sidebar_id=t(this).parent().parent().parent().find(".widgets-sortables"),t(this).hasClass("button-primary")){var s=sidebar_id;t(this).parent().slideToggle(50),i.animate({scrollTop:s.offset().top-50},200),sidebar_id.find(".widget").each(function(e,i){t(i).fadeOut(),wpWidgets.save(t(i),1,1,0)})}else t(this).parent().slideToggle(250);e.preventDefault()})}},e.ready(function(){wpWidgetOpts.init()})}(jQuery);